import * as React from 'react';
import * as ViewUtils from '../generated_views/view_utils'
import * as Models from '../generated_models'
//import PowerBIReport from '../powerbi-components/powerbi_report';
//import { models } from 'powerbi-client';
import { PowerBIReport } from '../powerbi-components/PowerBIReport';

// Embed configuration used to describe the what and how to embed.
// This object is used when calling powerbi.embed.
// This also includes settings and options such as filters.
// You can find more information at https://github.com/Microsoft/PowerBI-JavaScript/wiki/Embed-Configuration-Details.
/*
var config = {
  type: 'dashboard',
  tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
  accessToken: txtAccessToken,
  embedUrl: txtEmbedUrl,
  id: txtEmbedDashboardId,
  pageView: 'fitToWidth'
};
*/
////https://microsoft.github.io/PowerBI-JavaScript/demo/v2-demo/index.html#
interface PowerBIDashboardViewState {
  id: string
  embedUrl: string
  accessToken: string
};

class PowerBIDashboardView extends React.Component<ViewUtils.EntityComponentProps<Models.BIDiagram>, PowerBIDashboardViewState> {

  constructor(props, context) {
    super(props, context);
    this.state = {
     // id: "b5f50796-6e97-4dc5-a755-00cf4405e029",
    //  embedUrl: "https://app.powerbi.com/dashboardEmbed?dashboardId=b5f50796-6e97-4dc5-a755-00cf4405e029&groupId=be8908da-da25-452e-b220-163f52476cdd",
     // accessToken: 'H4sIAAAAAAAEACWWxQ70WA5G3-XfZqQwjdSLMFZSYdiFmTmtefepVu-tK-vc48_--883efopyf_89w8EYxLRksDo7xKxubaImEIfRygz2S1dqM7hQxCxZ7RRahfgnX3cmVr5Eb1BG9AepjWDL92Z2wOOmZQWHYxEzWyetaJUZkvpEcVKj0_XFZZBf6J-0beCNXkzRxTZe-Qv6KqKTeD3qux02HOXUNUyxs8fIuDzor8aDdNrPH-WA4u8TzNLOfR-_XAE9abzQj3lleH-cFh2kkgAlFcDZ4_uRKhsHA2M0dBn5vF-UQTBfaoWMiGsH6azp_RIuRUsNoTe8UaxOXy77-dgyGlVHVqsTARUyBCqMHkELrP2sclUHD3kaSyzx_THMgnQoJfan8624QnnU91hCpF55rcdJ0NqvsWdmDFTcaYlWTGPgUlxWMPHhwttXdbKZhVaQ2F_-F12b7-HYTHqFWyy5jJ7b-I9yUXf_G4UQvKCT23vJeXn3QXSbHwEBf-1m1q3R-n2OajainZ_Iwp95ykQQPN5SIPXywIVprhYlMqpJD6L9l4XO6HYC52Y49nmkmroWfGbfOeMqVS7cWZIv71GZiTDnOGznNgsTRujKWfG0Sbaa56NxbOviA9GyY_DWrvftBKWq4e3uGaJuwQ-kFW3uc1PLM3exnJ9qcHfUW9wsbLjwUT3rlpSypXwo6MlQLSsAcy4_Gd-LCopnw8rg8g4IdDJ0Cii6SHClxa3SUIArwLpAlSKc3mWz518dE4hDBj99NxRkMtTpaAjK8wqL6vPQ3mH92rcK5mS1UI4yX3IhlV9FrpY7yF7u_tHNTWg4Z395y_YukhIUpQMXI1R3tdy-6ZuoVXGiP6NaBt_iOTwOSOoAiLspzKmQJEjfyQg5UsZNb3fG03qKSfB9KaH-kZ_p4Yne9xN-igOCkXuoxsMQZCjBvFPXwI9XjJT7Y4HcgkWRn8aj0SepTh5ABXOFPuVWbJRu55q1GaFOuD-aAFS3AyT-YhGJA8KNlXPWikEXMzBd74Xpwl8xh8DuHLjru_tYXrcv8Sw-uk5ZgXhKeiN26uLPhYShMJvcHpLWs74fNd4sDU08T3ObHKJ-lbNCXnIXu2y8vgEuHav0ANwuAWUxaMcw1Im0p6SBOummSHj1SYsuC-xg4_sdVF14GMumWzfpYpTgBzYsYaZLiWPZhuGTbOEOzHmd2qs7HA9EZY1wwb70dYDN_FH2FC8RJzGPe5KPdfiaVMq9tqRr2VC9WaiJWwJAveluGqAjAFu6iwGsyPLy5q8hw1x-pHVsE3fdmTR4_LVPoIqVVSTHbwIxQ4aG2wacYeiUOzxkdwe6THZiUwkfaxck48gn2KmZKeayvwtAHx9opsM-TbF2J4nR1rEF6w2MCO6sbHUyjEkTDjoh0qnUO1Dny-3F1ArJPyqiso8HpfftkBdX9866enY8JJSj5O2bAJbG4Yq2uq5ynpkKwow6ta1aVEimqLlKqpMPZwN3Pmci28P8dRHVtUWBHN99zySlJamEnsQ0dwOxkNPUg70fl95M8qmewRKy5IOexlcwrbvBwdbqW3b00M4iqu7VuctIKDfGDGMWwUeY0aCRL-o2AQu137DenPGZOaMYqisNgiRrkU8PCnpSALGHGhWFq7ztBMUTcXw7aoFQ6Kjg7-78NEojr0bOW3V5n5A-V6BdeEiVbPFY4W9d5mAuYLHatNbmkAWih5WNx-BKC2ryijr_ggOWWGVQoS0Qbakzpav9eW7Q7AwGsnexh5jPrVPKOhCQ2c15DWg6m5miPmlrW053O25PQ5VyPa47W8T_SaNelDiuRipTL83iVr3r1W58Jz1k4GZE3HksNr30QU--ZVJYtjloJ3RLVnPjvcjrDHS8rtwNzx8jMJLjSgEEG8nqYarCDXOnqNOX09Qt-qoRbnu7byonM2D5ZgXJnSXK5G3KPy9p8qUMJFv0GSM0h4E3aUbqIWCJSUMyNcNmwofteNImFmbYMhi1Uf0s4FAYtDvBRkIjjA-cZm2sklwvPKkQ2Xw0wP2zG5wCt3qdlr9vB2plEsleHsAztskQRvq9K3hMGriHpryIISU8z7b0nTs85Zk_3CUPm8XBYQwQuRB0q0YiuQxkMWEOtilDy_w_IG2y-riPxtf0MsBlsSmxXVAhCyeJcFkjuQfcE9T9Z2ejt8EnfFu7SJSrdHxG3CEhCAsYTAZDQ-Z4zFjsmlNbPa5ldSN6mvXQyrnhghh2vga9Z731tS-vChLamEW62w7YIZ6DSaUhfbL8vH376QCK-O7NEj7FJXbjTnpnR9Fp6h9F5Zx73PDN31I5jrulHsoh_785w-3PvM-acXzO2dGxv114ak_X-t4H6jJqeGsbNyXjlr7AUuf9qX2gFOiUonlWHGf7mG9ni7AMB8cAuGqiDPNH_Tkjq-mFk6H2PPJXhuCfikp2jBKYL8G4cj5Pl-bQCgJ7pTRaXMs595XeZuKXXke6HPpyOTUmbp5bx6i6WHgsxPdlvZthCDOZzEEkoiHHFi4-eQ7T-KCXrDVH41STO6FVfOypKuda5aTm-46P0OHw8IaQ99aUTpq1gnhjA7D7-G7CdJlxFOO4cJ9VGkcdDrilVNQNcrTzHL0rvkyYkeUwzBhgr96gK2Ji1Yx7zlvgu3sB_SBYp4PhBUxvKSHfOBqsa8wTHSauYqjX_yKzF9__YP5metiVfwf5aYNiTvG31ZuMcfFrM1Pn-7fKqepxmQ_1uJXlhRX7hV7xnQX_LV6AyvUSCESB15Ea4IMqyiB70uF2_wL3riKAGbN410kQrzAuFl-2cWCbi3e2gvDOP-oy63tIeM7XOxmO4OPxuphUrzEBpM4I_jLb0eg3jzAKPiy9WzBo-exD8qu2iztbGN59-xp6Si3IMh9ExTVrGEFC0v_VPLeAarSfiqf7ICy25eV5BffaNzk61yt0RqBDeCVPo1ImPKvQXaFORHuMThMOYbbhL3hWc-fSX4D4vKKY2j5s-AHO2UKYfsNTph22vAeLP9bJ8zb-776ZJBqm8DvptZjvh1POR9qvDtv5HtVzWjX9gY7WKvKAQ8Rhf_ZMU6PDyQa5oW9rR_m__0fyXbM-MILAAA='
      embedUrl: "https://app.powerbi.com/reportEmbed?reportId=f6bfd646-b718-44dc-a378-b73e6b528204&groupId=be8908da-da25-452e-b220-163f52476cdd",
      accessToken:"H4sIAAAAAAAEAB2WRw6sCBJE7_K3jIR3I_UC771nBxS28B5ac_ep7n1IKWW8iMy__9jZ00_Z589__4i9vrtxilLuWYDy2plsaPizMN04UtUf6p7xEQnTl7hsfxALqqM3gNIt9CoLn5il_GAP1XP8it23W58uaIRB-x4rM-zVrFth2pFWVFgROiXNstG5IXeLQ-2c7dim7NqfVXSvEDAEblNw-4A2GU2rIkeXE7JPN_e0nkhggvu-aVAd9Vb6HYFLkjtgLlsSXIrsfv6NC3_0fFG2gQwpleNcHydxPvTLIfGUq-3R6sFI4qJq9Nea0XzsDCJJ1ufd4_FXPV29J2q_J0STL1aECu91hxkLaoSrDQOTiy6rHQc-WQeertWj4qzvEnAxYErh0YmqRx8TKxrZ_JZPTGvmjAyZi72pqIUOUV_UmwlEO3H-6mjHheoyDgwQp3tvzCmq-xY0CfHmDX3AlNLRpLW12llfFbWyk1SD8855u18I_7Y8Di3WUwnLVC8UHJt1E4ASKHlmyapst28dXE95hExMoDPQVHYdMIuExXwBgCLxyfYjcj8SG1plrt9f4vVEkTTh9BMCAUTKfONRCfIBeHgyeG-caGaRxRvM57KEZXHhXlbShmIv0GCMyWv6SLYlqLBLBh-_0xaTUWskeQS_BiGrBywA7LBREN40fKVY9aiS5g-LqmXmpYPKYzHd00ra3KIjkI8UcV2SI81mUQJVv8RxSsRcGv2Ym5zSFr9xPshLk-l1wm_Ld0zEORyzDAFdyYPN43P69VI-Cd6s-qJ-Q1XsvVzmAqK_y9XJvewraJddWY09pS7atZnU9ZcShQRvbHKFv6uWcS0AG9CgDmrlmfpKiTC8OxCOwthXRFYw6X1BjfiSdYJx6pbAnxaLba2enWut7T_24-Oq3M3VwELTYYlkdxCqsPBAeDyoztcXC1YuQU8Ce3mftN5Yp6VjEEuq2xoS8Q3DjPaynmQDI6hLf1ul3voK3wuaCZljz9te1pb1XCkWaXYbE4097SCi-29LNijgdYG--IhMiO6SzYCnEZi42LFCQSMZL3OJ47qYobBkQqz_-XQdyeG1Ak5OsJ87lCFLNj6c9qU1XB74I_cemWIbnzdzs6hCS7oMRDAM1pYQa2IENkaVyX1EdVZyy67s0e3eLyh-cXa8ns9I-6pwKEXBY0vrWATAZBTDUiMX1kogf2lzvp_gfqp6HIJQbJl3NhZ2mKih780nI3wwZ-OujwjOiyJR_REayEzdlfJpqnIxtqIfbYFygFRjNtJ8IZdhy3thnhtXMlWbybqM1TrbcpqzdHo7rTLGGVnlLJpPPVbF0LHBoZEk3LIfAxVPso2VBZ9MEQiqb0w_3kPImMNowKxYEIger4IVzG_q-ZIYHIxdmAOPK8aSpptOZfIOFdmLS5avHS-1QKdiKiH8XgZ2t01B_ayvWZr0s5HeqF0D-KArgDYnFE_k94FbJ8g_a_EyBAmDmmjlH28V-fot246gBmyGsIsQsqCk8L2bmuWUIOqAnddmVOBO1KY_VQbs3rKeo_wqvQ_jaaviUBmK-MhuhAc6WRKYwgQMieq6KJdgkJOFNwHai3gttkTJRX1MJ93M015IEBhMcSvAYenVunsxx6QV5YtnS6Iz1STXDGN_xo6-dq9IO8W6Q7y2XJqK7JmUl5ikCdz4q_APMoZkG2lyhTh5nu-tWd7fAfKLIEn6Li8bTtzXvfxIDMWqA1_fpmDFywJq6op-eHL1s4JkV58FHDhiUMEGX0D7YaE0wRd_zK8dXVo_gkyJEvE4Xzy-RxxsZNI7kDm1kZx3XAFTYfhm4ERjtqITpZb8EHxhpf5e9hqlNR0QiCTltKx78xG0WvBGX7w2EAG9k7XYbK10ydvykpgZ1z7TgNOJ_4yyysV9moKcwBh6qqeIjJjukLSjcNTd6BxGbxwiq8cDc1diTFqTgjXUvHDnukqDM3-q1GQ59kdmFzMZ1sOZqH4niP29HM-kdAp93S8HXbWdRcVIZ4YPIF035OmEnT3xmmE6eSGQOBaKIZBeg9bkfHiMmG6U7oANbXtx88DSkhMAM4psuIVV8GbFI5yi_fVknD_M75LIG8g8tuYbiLG8FgPNEeJUxkxHbdJDjNi0sI445AlAMqMEAS4x0PjxyBOe-ztvRVHzk-Sw9ZBIbNob7z0TG7Y1Pvvsus1juFrOStyq8tiQBW8bvV_TOelOJ2lLaJcQIec7osjivo6e8ZtJmPfxZVtPCEaNM0MaU1h5mNum0D27mmNdJfVxajw25b7Us9Ov4dIYEBjcgap79GMHMurhPqQa-uvPf_5w6zPvk1Y-v9dl-2ROtGVUxHIqVBZK436OrLF254IW72bjfXhZs_DO26iAOzSKIlUIJVVbR-EFaHUO48vMX7JNkvQjaLoM8vmZjb6VoeT9Im7Mar0dfwotLQUiSYqieqLAk1nzJJKOQqTPP4e8yXnA3VIeY07wzRpsYIY8iw1RCwS-qy3u-lZEOOIDjxQBd0MXMXr5ZsghRE1c3S4eEIO07-T6791IcFTXiVQG5iOdwwSeGF69JP_aAL9Ll18oIlDVmZIBGKWjhwoyfAhnk-V5QghDPE18kNkh1O0SbCYQJTfAefcL2r7SN7VVVr8otdgWcNHkikqzNxtyYTUo4WBXE0qhPLQWGYriwDTz179rfuamXJXwt-VcW3a9jhHOT1B9wYLJPp_r-lfltfWY7cda_mRhXcLbW5KB07tBWpus6vNsPTAhFGWg__Htm8n1UYQv1ud1UzlbJHbvnjVqPbWtQDxYuPS6StwISUhlT19S2Jm8Q2QoicaZL6Q8_FFa68EpkHlZ_Vri2UhGSC4Y0qijg6l5BNp-7yPN3NXSkgf7kDutFGKn8xa-34-PuEM5ILxr0qJ3YOqsVQGRBccWWMQvjDgWBgAF0Kd_I67xWhrZB4puYBAiuyBnB3aVyLldI4xpuehvyB1gTHFtT5F0xGvdHwRItFuOadOjcW1y29lRJvFU8TZ0j8JjzKFSeQoY8tWZzx87niTgEkawKPQyG8dMqVZp3CIqHkBPMvnjj4xFEnGtf8z43_8BY8rlJ64LAAA=",
      id:"f6bfd646-b718-44dc-a378-b73e6b528204"

    }
  }

  onEmbedded(embed) {
    console.log(`Report embedded: `, embed, this);
  }

  render() {
    return (
      <div>
        <h1>react-powerbi demo</h1>
        <PowerBIReport
          
          id={this.state.id}
          embedUrl={this.state.embedUrl}
          accessToken={this.state.accessToken}
          reportId="f6bfd646-b718-44dc-a378-b73e6b528204"
          mode = "View"
          
        />
      </div>
    );
  }
}

export default PowerBIDashboardView;

