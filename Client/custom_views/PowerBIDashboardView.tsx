import * as React from 'react';
import * as ViewUtils from '../generated_views/view_utils'
import * as Models from '../generated_models'
//import PowerBIReport from '../powerbi-components/powerbi_report';
//import { models } from 'powerbi-client';
import { PowerBIReport } from '../powerbi-components/PowerBIReport';

// Embed configuration used to describe the what and how to embed.
// This object is used when calling powerbi.embed.
// This also includes settings and options such as filters.
// You can find more information at https://github.com/Microsoft/PowerBI-JavaScript/wiki/Embed-Configuration-Details.
/*
var config = {
  type: 'dashboard',
  tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
  accessToken: txtAccessToken,
  embedUrl: txtEmbedUrl,
  id: txtEmbedDashboardId,
  pageView: 'fitToWidth'
};
*/
////https://microsoft.github.io/PowerBI-JavaScript/demo/v2-demo/index.html#
interface PowerBIDashboardViewState {
  id: string
  embedUrl: string
  accessToken: string
};
 
class PowerBIDashboardView extends React.Component<ViewUtils.EntityComponentProps<Models.BIDiagram>, PowerBIDashboardViewState> {

  constructor(props, context) {
    super(props, context);
    this.state = {
     // id: "b5f50796-6e97-4dc5-a755-00cf4405e029",
    //  embedUrl: "https://app.powerbi.com/dashboardEmbed?dashboardId=b5f50796-6e97-4dc5-a755-00cf4405e029&groupId=be8908da-da25-452e-b220-163f52476cdd",
     // accessToken: 'H4sIAAAAAAAEACWWxQ70WA5G3-XfZqQwjdSLMFZSYdiFmTmtefepVu-tK-vc48_--883efopyf_89w8EYxLRksDo7xKxubaImEIfRygz2S1dqM7hQxCxZ7RRahfgnX3cmVr5Eb1BG9AepjWDL92Z2wOOmZQWHYxEzWyetaJUZkvpEcVKj0_XFZZBf6J-0beCNXkzRxTZe-Qv6KqKTeD3qux02HOXUNUyxs8fIuDzor8aDdNrPH-WA4u8TzNLOfR-_XAE9abzQj3lleH-cFh2kkgAlFcDZ4_uRKhsHA2M0dBn5vF-UQTBfaoWMiGsH6azp_RIuRUsNoTe8UaxOXy77-dgyGlVHVqsTARUyBCqMHkELrP2sclUHD3kaSyzx_THMgnQoJfan8624QnnU91hCpF55rcdJ0NqvsWdmDFTcaYlWTGPgUlxWMPHhwttXdbKZhVaQ2F_-F12b7-HYTHqFWyy5jJ7b-I9yUXf_G4UQvKCT23vJeXn3QXSbHwEBf-1m1q3R-n2OajainZ_Iwp95ykQQPN5SIPXywIVprhYlMqpJD6L9l4XO6HYC52Y49nmkmroWfGbfOeMqVS7cWZIv71GZiTDnOGznNgsTRujKWfG0Sbaa56NxbOviA9GyY_DWrvftBKWq4e3uGaJuwQ-kFW3uc1PLM3exnJ9qcHfUW9wsbLjwUT3rlpSypXwo6MlQLSsAcy4_Gd-LCopnw8rg8g4IdDJ0Cii6SHClxa3SUIArwLpAlSKc3mWz518dE4hDBj99NxRkMtTpaAjK8wqL6vPQ3mH92rcK5mS1UI4yX3IhlV9FrpY7yF7u_tHNTWg4Z395y_YukhIUpQMXI1R3tdy-6ZuoVXGiP6NaBt_iOTwOSOoAiLspzKmQJEjfyQg5UsZNb3fG03qKSfB9KaH-kZ_p4Yne9xN-igOCkXuoxsMQZCjBvFPXwI9XjJT7Y4HcgkWRn8aj0SepTh5ABXOFPuVWbJRu55q1GaFOuD-aAFS3AyT-YhGJA8KNlXPWikEXMzBd74Xpwl8xh8DuHLjru_tYXrcv8Sw-uk5ZgXhKeiN26uLPhYShMJvcHpLWs74fNd4sDU08T3ObHKJ-lbNCXnIXu2y8vgEuHav0ANwuAWUxaMcw1Im0p6SBOummSHj1SYsuC-xg4_sdVF14GMumWzfpYpTgBzYsYaZLiWPZhuGTbOEOzHmd2qs7HA9EZY1wwb70dYDN_FH2FC8RJzGPe5KPdfiaVMq9tqRr2VC9WaiJWwJAveluGqAjAFu6iwGsyPLy5q8hw1x-pHVsE3fdmTR4_LVPoIqVVSTHbwIxQ4aG2wacYeiUOzxkdwe6THZiUwkfaxck48gn2KmZKeayvwtAHx9opsM-TbF2J4nR1rEF6w2MCO6sbHUyjEkTDjoh0qnUO1Dny-3F1ArJPyqiso8HpfftkBdX9866enY8JJSj5O2bAJbG4Yq2uq5ynpkKwow6ta1aVEimqLlKqpMPZwN3Pmci28P8dRHVtUWBHN99zySlJamEnsQ0dwOxkNPUg70fl95M8qmewRKy5IOexlcwrbvBwdbqW3b00M4iqu7VuctIKDfGDGMWwUeY0aCRL-o2AQu137DenPGZOaMYqisNgiRrkU8PCnpSALGHGhWFq7ztBMUTcXw7aoFQ6Kjg7-78NEojr0bOW3V5n5A-V6BdeEiVbPFY4W9d5mAuYLHatNbmkAWih5WNx-BKC2ryijr_ggOWWGVQoS0Qbakzpav9eW7Q7AwGsnexh5jPrVPKOhCQ2c15DWg6m5miPmlrW053O25PQ5VyPa47W8T_SaNelDiuRipTL83iVr3r1W58Jz1k4GZE3HksNr30QU--ZVJYtjloJ3RLVnPjvcjrDHS8rtwNzx8jMJLjSgEEG8nqYarCDXOnqNOX09Qt-qoRbnu7byonM2D5ZgXJnSXK5G3KPy9p8qUMJFv0GSM0h4E3aUbqIWCJSUMyNcNmwofteNImFmbYMhi1Uf0s4FAYtDvBRkIjjA-cZm2sklwvPKkQ2Xw0wP2zG5wCt3qdlr9vB2plEsleHsAztskQRvq9K3hMGriHpryIISU8z7b0nTs85Zk_3CUPm8XBYQwQuRB0q0YiuQxkMWEOtilDy_w_IG2y-riPxtf0MsBlsSmxXVAhCyeJcFkjuQfcE9T9Z2ejt8EnfFu7SJSrdHxG3CEhCAsYTAZDQ-Z4zFjsmlNbPa5ldSN6mvXQyrnhghh2vga9Z731tS-vChLamEW62w7YIZ6DSaUhfbL8vH376QCK-O7NEj7FJXbjTnpnR9Fp6h9F5Zx73PDN31I5jrulHsoh_785w-3PvM-acXzO2dGxv114ak_X-t4H6jJqeGsbNyXjlr7AUuf9qX2gFOiUonlWHGf7mG9ni7AMB8cAuGqiDPNH_Tkjq-mFk6H2PPJXhuCfikp2jBKYL8G4cj5Pl-bQCgJ7pTRaXMs595XeZuKXXke6HPpyOTUmbp5bx6i6WHgsxPdlvZthCDOZzEEkoiHHFi4-eQ7T-KCXrDVH41STO6FVfOypKuda5aTm-46P0OHw8IaQ99aUTpq1gnhjA7D7-G7CdJlxFOO4cJ9VGkcdDrilVNQNcrTzHL0rvkyYkeUwzBhgr96gK2Ji1Yx7zlvgu3sB_SBYp4PhBUxvKSHfOBqsa8wTHSauYqjX_yKzF9__YP5metiVfwf5aYNiTvG31ZuMcfFrM1Pn-7fKqepxmQ_1uJXlhRX7hV7xnQX_LV6AyvUSCESB15Ea4IMqyiB70uF2_wL3riKAGbN410kQrzAuFl-2cWCbi3e2gvDOP-oy63tIeM7XOxmO4OPxuphUrzEBpM4I_jLb0eg3jzAKPiy9WzBo-exD8qu2iztbGN59-xp6Si3IMh9ExTVrGEFC0v_VPLeAarSfiqf7ICy25eV5BffaNzk61yt0RqBDeCVPo1ImPKvQXaFORHuMThMOYbbhL3hWc-fSX4D4vKKY2j5s-AHO2UKYfsNTph22vAeLP9bJ8zb-776ZJBqm8DvptZjvh1POR9qvDtv5HtVzWjX9gY7WKvKAQ8Rhf_ZMU6PDyQa5oW9rR_m__0fyXbM-MILAAA='

     // embedUrl: "https://app.powerbi.com/reportEmbed?reportId=f6bfd646-b718-44dc-a378-b73e6b528204&groupId=be8908da-da25-452e-b220-163f52476cdd",
    //  accessToken:"H4sIAAAAAAAEAB2Wx66EWpJF_-VNKQnvSqoB3nvPDHtIPCQmodX_3rd6vhWDtXaE4n_-cYtnXIr6n3__QzTG85XSTbLY1ajwHxzKm3jj0HTC19MJ335tQvV0NY9ogeaTQLqa5Vk-JCPg01JnoajKVoMW7Sp1VBEwuMxdS9Co6vcdIRwDh4j1NzXmx_rFuYLpNbrn-Z7vvLVMd1MMROuz_7p4vx25SGntNRZjqvsD6Z5Z9lK5QBXl8KBpFTccfizld2v6kQG-nWH-HtR3UGSvAKwwOJ1pDwGHn0kwET52oGQNim3iRoyXay3aQi_y3mzOGeoVm-SUM2g2L2e3ZuPOGE4l2SUI7HZiZLj4SUlR-eBDF_vrfnjEh5BzJJUhgFY08a7tWafC-OxH9Dfh0e3Oakmpd6QA87oFVKOVKncv_qzL-6SihedOrrJWRWlpj8XEKrd7sVhR7BhPCgvZ4UtTwIocvH_Za-YiNlZzM-qcsKkYAqycaHvop4rqXbCmsS0WipT76TgrGzPxqQkH6OS2wKIhX0X45D1uaBkgG9cKcMDr8kCJF2X0ADxXfMpe9SnSfEqwYkIKD9LVld_T7ZBTAlC9ylRlIG4svlAVD8brCV657cckzbWtbBiDG1q-f7RML0kb2-qEbLk8XvylufOk-Oldb0LE3qdIxTIVwRzZ6ngQ6ivrNo4QSljv7YaSRNEONtKo5ZuozixuoHOg4RJ0ERxq8kWQeeN0tC8nfO_1ala1kf0vDfZd_jEgqcg3vLfK-ooG1PbFynkub2KYZp7-IUCjkgeeRlA98lF86W5bK3N5o__GiLRBydVFnRk5-P3W3J0k4JRPfniccvNEdeckTkNTVbUg5zk26EsSaam9EtKvO7ojZVWQAMi4RA6qefFbc9ijhAWZ0VbBW4jueNBFerhwT9ygWAiWAq-E3fMf5vj-Ioca4sm31WqhknbQMW1Rh0Im6MMvnlicIpHep2l2Ep9NDeJWpuriUyv7l4oexXYuWssTvmRBaVJ0udjsl9maiVOyGVLvu4OeB3fi2XCyruO17ShR65oUWIS0lHKmzeLKt5TeEP1FDAfR12v_cY3pho18qE9brAtojCBLhMTCmmh2mxvpgZPS3uLjRPowSyv7dmi2ASJMrK0NilJOw9_u9VXQGg14gu1Yjvi382F1i2gAfcSAmnDj1H7k9uyC-gq7sqfOTL9k7vGq-eHZ_ocWGvwFd7iyuWkaoLpQ9SptquL78TfR6midBINS_tpWkMj7HiEUagmYvfzgI_NXfp8YVjJ67YS-NrHPc8t0oHXDK6kLytgQyWVtTeAqER8X_V1fjll-F4rWV5U_XYyabmN9_uqRe3k8yP6fX2fc-MIvALxSsNpcqwET88_-gdKBk9aJuMu-OwvhXdL2V-_CglnsbJehl_yBmgksO_LyN48FLsh0wIYjHpb9fr0uZgLTVJN0ly5ihVFvy1IZ5qzmyJC4Y-nB9kHwPRJNEqsqsMWCkLxswm9qjfrp-iHD-ksb3YDOleK1OO4s4BnsBAkUAOaKmMUIWl9kglVaVvZWemjmscKIi5esSRAKasdfI-_ppVCE6npmPKe_8tDWOFH0LHQvmUEphf6qd6OPMofvRog1ixS598UBth9OdTFWbtmYGR1uBuHvHFHJzEE4Tt3CWYWW7VTZNPshp41uZh7SQRWJV3kNjNN4hgluoQ8U8luN6hcemwis10kRGZNHIXQydWy1DBuiQUse0sNl-ZTTakdkaYeJFVka82AvSvcriaAGJpH3gSF3iR-eOtxBISP_fkIHj8l9ZmoCCe7mVjC9Ld3gmPizwnsQGyv9ud9-ptaiSuL6dJV0HzG17RCaVD8soa0tCz8uSQMsMt4HJsXVPIz7LmRyxIRxIwbeyKuILftIIUknbfs5_lgktWB6f1y63uEEL7j1c7rb-pUUqYOdHNR1F9pDMb63VetJhHl9zMQNDQfhSnjME24rHA39REe7mxgmEgW7-61h9NJCLviNUoESL12U9QMEJj-S9TnSbTB9zQamq2d6oB3gQ9wGLhd7sK4K-L1BBbIeYf80b0AlQkiKru8Rzw2faEhQ-k7Ob0bL7m_LN5gYNBcyqF3CfXkafUlBRlWpcEXxM0sJXJWNLDGJf56UCysTa3y2g_Yy0FJ4EsnP69xAx062x-7QVynJ9QpvH6nXidsCrhbM5VM1cNpakES_9wcGS4nGVIYy_4XyUWsqPSFCvp5SN-j1sQQq7HbA6OXRAlVZERhyTnJB3cY___pH2J_1WIzm-XtHjq4ThbQPERl1Sw1G6NV1ZCpUyHTgTDxP8obQzbH7aBPSq2-a7bSSgtw2B58UdgmDSnqgQ-X6u6dfU7TQ_gvhDydM3GEkRswZTxQqVlPRoNwodMLA78A-lbnYxddeuoAq5vMgmJpQMsophTJr1h5BlYesdKGMRViPYoIiX3tA3Wn0XCJXGetTf5OfixEgyhAe6nv9d8a4bRDSVl7svFXKLSP4dXzm8ByMXtJzbSU6nSMN2z09rAMaOWliSphdWYqfn5_1N4P2kn38WGMmIjAi-FqyAYD1znAiDYE6e9XHgit3HKdxdmYjHaFSb0OhJ19Krd34hK_aGu0Yvu0RdzIJMpy5__znv5iftWt2Lf6jrCtTlzgsDzW9oXzTLPIzmQD_nwo-YC6Oc2_-YrJQKzHFJ-jI4mItwj1l1lzsN9o0FU9g2ZOPePqO7CWh1jlq97OIuJKPCkVXFbXIbFmowok0b7QGq_gk-Am3ZN_nRJucYYrpHaDN9gqtVPqv3KJCeExf61aDfsD9y0mNI77Sbf6pRpVzl1FGGPR5Q7qM5mozEkBps0FASfl5VcuPiqM-8Ao_2PDO0qO-LBzoH6vISVReysDFj-80fyKjXl_3lRErHjBuHLCVUpX2MNLvfnUwbEVtiX466xODmxhRx6K12IzUYSNEEZV76iF_rudGqcvDVnUGII_eYfYq4narMG3QrxyZhPygXd_xFeQ3Yia5B0ZGIJUexikfgxKBsAjlf2X87_8BZMKzeoILAAA=",
    //  id:"f6bfd646-b718-44dc-a378-b73e6b528204"

      accessToken: "H4sIAAAAAAAEAB1Wxa7FCpL7l7dNS2FqqRdh5hPchZk5o_n3udN7q6SyXXb9zz92-g5zWvzz738U5bvIfN5_RNpgZcwQJcMua8juHdaPkvjqNcjf7gfzjRhpADc6qo55z7IpPY-nLcVZ-AOfzNQGiF3bKQR9MfZ-E78NfETrFEjk2abxEV4z3y0ZK3i5k-BWHdjSMkI9hX7tkb94RMi0xLDnMPz-PLrMa4-2KWh9o68jfhklerQMUcUJA0zY_vYh06UHwuPKyiyMtJZQaa3jSMnwpS1SEaNDm4jhMnwKZSON8dul4QWDDhc-adAy_jm6anrHxgNYl2PieHlezva7ssErlE-tk3BFXu98hhpSNJPnKrhdudzAWVTGOKepjUnGUdCCbgjG1GXqc-96i9wM_LdF7kV6dw_2UXC4Uff8lS9tSKdoXLFU8AZB05jZBiR8bQKFIRKBzYnm-HaO9ThSuR8dmRkP6LBFWkgVRGSUYinZ0--tK8pATrqOx7uLX8VpM5CwVXRNu7mIkOUKcTGegBv6dRnV6VembJUsHItBbGbyBcvEsM2QPlSL7WawbbOs0VBwFy0mj-1FyQ8JIZLS6pQZdFi4ZPC9hf7a7GF2Cqg81zp_LRUo-OMIT3N7vm39kWhCgv3I_XYNkCZNIYpV205x3ulAv_XSJaS8JwXnlt1XepigR7NC035NSimivBA6VFV_94im2gHi6hQPVv3t2VWxY_FYjWRlsOtUWe1HWPOqnFEwsY7NNMNPFMcfxcP-5rL-bNPOL3HiJ-Jk0rffa6kk4HeOoqQBNJMN6khwtWuI0SWEDfum1O4GfIyjSFoA45_HOK5PwNJVe4d8Gw0pEd5pkLbfmWrkZhjvmrW7obm_OJmOUEs49Rf5pl3kcMdwkC8yrI15iLCKuwQoae8WV1IFGPOdCcqattN_TXjvz17dPY1EvSzg3FfkwJbhQLLJwWQP0EBJr8n7vSatihn-bMEDT4j1sEo5e99PRI25wBYYOSRc9_QG61oIc-9lbNUeihv80HbeTuTqDOm6bwnF3eg4YjLx1gP4T8xUiW-11X1-7Bz6q6JWpPBeYraqFUscrJcTp9SVN5OUWQhv8MAsgwuKT6JJcit2Mt29x4NmVNRQAV_HjaER_k6et_i1512WivGuLpt70evZSzTua2ahyFygXkDWK1X4M5NvdFyRky8SRplDfI-jXsSvnzF7izUCq6RbrJM9i4QhlylIQpCBPEASiVKPZdf2gjuhCIkT3sRL8dG1mh77iD_AehIdlDwtunoymbWNCDlPzyyy9uN6uvsU4fVvKGakokcaqAj58wtUiB9MonY2S0T3MG3oV4dsoCauzzDmXmuaElvRlLC5T4FGkuzK2FoWuLAYFfLUAGTIRG5ShqGFAxlB68UYrHZeAZFFSHV0l1RF3Te8n-GZR7FPrGQlb0EvdQ3IMZA80kLiR1AGj2g1vVpJDdk1lui_hCxbRZPG1mjzVsZ_IgFRggSgepCYpS_AsjvBSMlficDntXZyeN5Q4pjMrNnt29T6S4xBC16wHAg85E8Axag_0wVpUbjFcTFs0JhlLy5h8HG3nLhuCgd0vTL1DjHg6vkNT_hUMYpmJT0bwiBOFrW08fGUwzgE3vZvIMv4fRK0pofc2R5Q2xRUjDzAhWYodhvNHeFgu20y5jKh7BnwpqNWvRuujqN2g2S8Ll4D67o0vfQxwroq1K2YEmovqgHuntFSpceWajhdv5bFmbXko-VpbXRgKxg9fhjW7iPweaKWGXIn3zv76kgTe11lSAOcRVe4oxsICkTv6xurSzNvvhUEQYHTnRnbGXrdRUpolND2i30KmVIcfwGfdUOUON9VGqtF5-rOmWADYZC6NXXq44VDi10YMkFqCumxlEflmilSj70cUMuFxA88TTEiX2YiYgMBWfP49DW_9n6sIW0hq5Y1hYMOd4WVqhJ_KfW1_KB1okEgUYQNjHqKrS75Ql4sv1K4U00wvJgqedmt_dPj_0IVkA3JSsB5Ae_VtZjZ_miw-VxSxz9E6lIj8YcDhFtCNqwOPf58GovgKYEqRdOYosvprtDi-KlUghatdEIHk550QppJAgGgRDj6_dbCufb24oSo-3EVJQPTpLwVzNp1-OE02Y_pqFILFS8rrtuEHEV2-OQHCcIh1Y6qTP1Si2D-88-__uG2dzlmrXz_XofpzZe-m08w-qk0lrzBZ1eEl_droEv60kQQj0AHx2ADTTeVbbzH3CQcxWZtLm8VMdca6usrjRDsRWc0kIYAgaG_CLuJz7n4rntWcQANaDtoptbiouCQU_rZtpZuuk-EPnh7QSihg3EsY6y70V_HM0DLVGk2QuHfbTA_pM3QYDVZ_TgyU_n7JeblG87ZJW81yb6LyE025fNxvFAAtIOd-HDzB50VNDLyuMfF4uAz6mb0J5psFkYfT0BeXHzdMD9BjoYjQrMiR6gT8JbuA-rLjTLX4d4E7-ekWrWXjDxOEjzCh4u4aJFgH0HMxCGux6494yUR4rffdvY326fnEsi2IClmQzH_-S_N79KUmxL8sezpy_W6lernXp9xW4ad7W7W_0V5bT2lx7mVf7BhL63PrNXAjOce5-SRoTxd6vSuKnA7rZIYtJ_dZqul7T_Suicd9lMllGkj-lrp66oUH8AZKwybEC7tSZu_PrJbnQLMPLzvzFPmoGnx8ArHL1z8lVHxNMkhOvUphUJ7fwbgH6aAsjnUxKa2TZD5tt9DP61PwyWFGdVO7nH09DvqnF1OEYTa6YzCDzpDF0ObPAoROjkw_5wRFVTd4i4DnM2DX4zK38OJeRgosB8690m5Fp_AgTvvEOqVgfNhCw5PR7eTEeNMEG9Pblc-FegSlkxZCsDUkT2SrTr_tI5MNtsr33lwEl4PPwPLm6ZKFwR4eNSSQok11C1zflSB1rSazwKo_b8Y__t_-qXKDi4LAAA="
      , embedUrl: "https://app.powerbi.com/reportEmbed?reportId=94e1e85c-1bce-4d7b-ad4b-ec033d76f687&groupId=67e42a29-223a-4249-b5ed-18afc811024f"
      , id: "94e1e85c-1bce-4d7b-ad4b-ec033d76f687"
    }
  }

  onEmbedded(embed) {
    console.log(`Report embedded: `, embed, this);
  }

  render() {
    return (
      <div>
        <h1>react-powerbi demo</h1>
        <PowerBIReport
          
          id={this.state.id}
          embedUrl={this.state.embedUrl}
          accessToken={this.state.accessToken}
          
          mode = "View"
          
        />
      </div>
    );
  }
}
//reportId="f6bfd646-b718-44dc-a378-b73e6b528204"
export default PowerBIDashboardView;

